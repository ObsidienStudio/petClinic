pipeline {
    agent any

    stages {
        stage('Build') {
            steps {
                echo "Building..."
                step ([$class: 'CopyArtifact',
                        projectName: 'petClinic',
                        target: 'C:/Users/33767/Documents/GitHub/petClinic']
                );
                echo "Building finished"
            }
        }

        stage('Deploy') {
            steps {
                bat 'robocopy C:\\Users\\33767\\Documents\\GitHub\\petClinic\\target C:\\Users\\33767\\Documents\\CODE\\cefim-jenkins-box\\cefim-jenkins-box-master\\data *.jar /MOVE'
                bat 'cd C:\\Users\\33767\\Documents\\CODE\\cefim-jenkins-box\\cefim-jenkins-box-master\\ && vagrant up'
                bat 'cd C:\\Users\\33767\\Documents\\CODE\\cefim-jenkins-box\\cefim-jenkins-box-master\\ && vagrant ssh'
            }
        }
        stage('SSH'){
  def remote = [:]
  remote.name = 'vagrant'
  remote.host = 'vagrant'
  remote.user = 'vagrant'
  remote.password = 'vagrant'
  remote.allowAnyHosts = true
    sshCommand remote: remote, command: "ls -lrt"
    sshCommand remote: remote, command: "for i in {1..5}; do echo -n \"Loop \$i \"; date ; sleep 1; done"
  
}
        }
            }
        